Data Science HW-5
================
Kasturi Bhamidipati
2022-11-14

# Problem 1

# Problem 2

## Importing the data

First we want to import the data.

``` r
homicide_raw = 
  read_csv(file = "./data/homicide-data.csv")
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

## Summary of the dataset

|                                                  |              |
|:-------------------------------------------------|:-------------|
| Name                                             | homicide_raw |
| Number of rows                                   | 52179        |
| Number of columns                                | 12           |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |              |
| Column type frequency:                           |              |
| character                                        | 9            |
| numeric                                          | 3            |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |              |
| Group variables                                  | None         |

Data summary

**Variable type: character**

| skim_variable | n_missing | complete_rate | min | max | empty | n_unique | whitespace |
|:--------------|----------:|--------------:|----:|----:|------:|---------:|-----------:|
| uid           |         0 |             1 |   9 |  10 |     0 |    52179 |          0 |
| victim_last   |         0 |             1 |   1 |  20 |     0 |    12687 |          0 |
| victim_first  |         0 |             1 |   1 |  28 |     0 |    16640 |          0 |
| victim_race   |         0 |             1 |   5 |   8 |     0 |        6 |          0 |
| victim_age    |         0 |             1 |   1 |   7 |     0 |      102 |          0 |
| victim_sex    |         0 |             1 |   4 |   7 |     0 |        3 |          0 |
| city          |         0 |             1 |   5 |  14 |     0 |       50 |          0 |
| state         |         0 |             1 |   2 |   2 |     0 |       28 |          0 |
| disposition   |         0 |             1 |  14 |  21 |     0 |        3 |          0 |

**Variable type: numeric**

| skim_variable | n_missing | complete_rate |        mean |         sd |          p0 |         p25 |         p50 |         p75 |          p100 | hist  |
|:--------------|----------:|--------------:|------------:|-----------:|------------:|------------:|------------:|------------:|--------------:|:------|
| reported_date |         0 |             1 | 20130899.16 | 1123419.63 | 20070101.00 | 20100318.00 | 20121216.00 | 20150911.00 | 201511105\.00 | ▇▁▁▁▁ |
| lat           |        60 |             1 |       37.03 |       4.35 |       25.73 |       33.77 |       38.52 |       40.03 |         45.05 | ▁▅▅▇▅ |
| lon           |        60 |             1 |      -91.47 |      13.75 |     -122.51 |      -96.00 |      -87.71 |      -81.76 |        -71.01 | ▃▁▃▇▅ |

-   The `homicide` dataset has 52179 rows and 12 columns.
-   It has the following variables: uid, reported_date, victim_last,
    victim_first, victim_race, victim_age, victim_sex, city, state, lat,
    lon, disposition
-   It provides details on the date of the homicide, the victims’ name,
    age, sex, city and state.
-   It also had additional notes on the status of the case.

## Creating `city_state` variable and summarizing

``` r
homicide_data = 
  homicide_raw%>%
  unite("city_state", city:state, remove = FALSE, sep=", ") %>%
  group_by(city_state) %>%
  count(disposition, name = "total_dispositions")%>%
  pivot_wider(
    names_from= "disposition",
    values_from= "total_dispositions"
    )%>%
  janitor::clean_names()%>% 
  replace(is.na(.), 0)%>%
  mutate(
    total_homicides = closed_by_arrest+closed_without_arrest+open_no_arrest, 
    unsolved_homicides = closed_without_arrest+open_no_arrest
  )
```

## `prop.test` for Baltimore

``` r
baltimore= 
  prop.test(
  homicide_data %>%  
    filter(city_state == "Baltimore, MD") %>% 
    pull(unsolved_homicides),
  homicide_data %>%
    filter(city_state == "Baltimore, MD") %>% 
    pull(total_homicides)
  ) %>% 
  broom::tidy()%>%
  select(estimate, conf.low,conf.high)
```

## `prop.test` for each city

``` r
homicide_data_pt = 
  homicide_data%>%
  mutate(
    proportions = map2(.x = unsolved_homicides, .y = total_homicides, ~prop.test(x = .x, n = .y)),
    tidied = map(.x = proportions, ~broom::tidy(.x))
    ) %>% 
  select(-proportions) %>% 
  unnest(tidied) %>% 
  select(city_state, estimate, conf.low,conf.high)
```
